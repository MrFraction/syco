#################################################
# rsnapshot.conf - rsnapshot configuration file #
#################################################
#                                               #
# PLEASE BE AWARE OF THE FOLLOWING RULES:       #
#                                               #
# This file requires tabs between elements      #
#                                               #
# Directories require a trailing slash:         #
#   right: /home/                               #
#   wrong: /home                                #
#                                               #
#################################################

#######################
# CONFIG FILE VERSION #
#######################

config_version	1.2

###########################
# SNAPSHOT ROOT DIRECTORY #
###########################

# All snapshots will be stored under this root directory.
#
snapshot_root		/opt/backup/rsnapshot/

# If no_create_root is enabled, rsnapshot will not automatically create the
snapshot_root		/opt/backup/rsnapshot/
# up to removable media, such as a FireWire or USB drive.
#
#no_create_root	1

#################################
# EXTERNAL PROGRAM DEPENDENCIES #
#################################

# LINUX USERS:   Be sure to uncomment "cmd_cp". This gives you extra features.
# EVERYONE ELSE: Leave "cmd_cp" commented out for compatibility.
#
# See the README file or the man page for more details.
#
cmd_cp		/bin/cp

# uncomment this to use the rm program instead of the built-in perl routine.
#
cmd_rm		/bin/rm

# rsync must be enabled for anything to work. This is the only command that
# must be enabled.
#
cmd_rsync	/usr/bin/rsync

# Uncomment this to enable remote ssh backups over rsync.
#
cmd_ssh		/usr/bin/ssh

# Comment this out to disable syslog support.
#
cmd_logger	/usr/bin/logger

# Uncomment this to specify the path to "du" for disk usage checks.
# If you have an older version of "du", you may also want to check the
# "du_args" parameter below.
#
cmd_du		/usr/bin/du

# Uncomment this to specify the path to rsnapshot-diff.
#
#cmd_rsnapshot_diff	/usr/local/bin/rsnapshot-diff

# Specify the path to a script (and any optional arguments) to run right
# before rsnapshot syncs files
#
#cmd_preexec	/path/to/preexec/script

# Specify the path to a script (and any optional arguments) to run right
# after rsnapshot syncs files
#
#cmd_postexec	/path/to/postexec/script

#########################################
#           backup		INTERVALS            #
# Must be unique and in ascending order #
# i.e. hourly, daily, weekly, etc.      #
#########################################

interval	hourly	6
interval	daily	7
interval	weekly	4
interval	monthly	12

############################################
#              GLOBAL OPTIONS              #
# All are optional, with sensible defaults #
############################################

# Verbose level, 1 through 5.
# 1     Quiet           Print fatal errors only
# 2     Default         Print errors and warnings only
# 3     Verbose         Show equivalent shell commands being executed
# 4     Extra Verbose   Show extra verbose information
# 5     Debug mode      Everything
#
verbose		3

# Same as "verbose" above, but controls the amount of data sent to the
# logfile, if one is being used. The default is 3.
#
loglevel	3

# If you enable this, data will be written to the file you specify. The
# amount of data written is controlled by the "loglevel" parameter.
#
logfile	/var/log/rsnapshot

# If enabled, rsnapshot will write a lockfile to prevent two instances
snapshot_root		/opt/backup/rsnapshot/
# If you enable this, make sure the lockfile directory is not world
# writable. Otherwise anyone can prevent the program from running.
#
lockfile	/var/run/rsnapshot.pid

# Default rsync args. All rsync commands have at least these options set.
#
#rsync_short_args	-a
#rsync_long_args	--delete --numeric-ids --relative --delete-excluded

# ssh has no args passed by default, but you can specify some here.
#
#ssh_args	-p 22

# Default arguments for the "du" program (for disk space reporting).
# The GNU version of "du" is preferred. See the man page for more details.
# If your version of "du" doesn't support the -h flag, try -k flag instead.
#
#du_args	-csh

# If this is enabled, rsync won't span filesystem partitions within a
# backup		point. This essentially passes the -x option to rsync.
# The default is 0 (off).
#
#one_fs		0

# The include and exclude parameters, if enabled, simply get passed directly
# to rsync. If you have multiple include/exclude patterns, put each one on a
# separate line. Please look up the --include and --exclude options in the
# rsync man page for more details on how to specify file name patterns.
#
#include	???
#include	???
#exclude	???
#exclude	???

# The include_file and exclude_file parameters, if enabled, simply get
# passed directly to rsync. Please look up the --include-from and
# --exclude-from options in the rsync man page for more details.
#
#include_file	/path/to/include/file
#exclude_file	/path/to/exclude/file

# If your version of rsync supports --link-dest, consider enable this.
# This is the best way to support special files (FIFOs, etc) cross-platform.
# The default is 0 (off).
#
#link_dest	0

# When sync_first is enabled, it changes the default behaviour of rsnapshot.
# Normally, when rsnapshot is called with its lowest interval
# (i.e.: "rsnapshot hourly"), it will sync files AND rotate the lowest
# intervals. With sync_first enabled, "rsnapshot sync" handles the file sync,
# and all interval calls simply rotate files. See the man page for more
# details. The default is 0 (off).
#
#sync_first	0

# If enabled, rsnapshot will move the oldest directory for each interval
# to [interval_name].delete, then it will remove the lockfile and delete
# that directory just before it exits. The default is 0 (off).
#
#use_lazy_deletes	0

###############################
### backup		POINTS / SCRIPTS ###
###############################

#backup	/var/log/rsnapshot		localhost/

#backup	/home/foo/My Documents/		localhost/
#backup	/foo/bar/	localhost/	one_fs=1, rsync_short_args=-urltvpog

# EXAMPLE.COM
#backup_script	/bin/date "+ backup		of example.com started at %c" > started	00started
#backup	root@example.com:/home/	example.com/	+rsync_long_args=--bwlimit=16,exclude=core
#backup	root@example.com:/etc/	example.com/	exclude=mtab,exclude=core
#backup_script	ssh root@example.com "mysqldump -A > /var/db/dump/mysql.sql"
#backup	root@example.com:/var/db/dump/	example.com/
#backup_script	/bin/date "+ backup		of example.com ended at %c" > ended		01ended

# CVS.SOURCEFORGE.NET
#backup_script	/usr/local/bin/backup_rsnapshot_cvsroot.sh	rsnapshot.cvs.sourceforge.net/

# RSYNC.SAMBA.ORG
#backup	rsync://rsync.samba.org/rsyncftp/	rsync.samba.org/rsyncftp/

# Exclude all folders named NoBackup
exclude	NoBackup

# Start backup
backup_script	/bin/date "+ backupof example.com started at %c" > started	00started

#
# backupTC environment (the fox server at tp)
#

# fo-tc-mysql
backup			root@10.100.110.142:/etc/									mysql1-tc/
backup_script	/usr/bin/ssh root@10.100.110.142 "/root/backup-mysql.sh"	mysql1-tc/.dummy/snapshot
backup			root@10.100.110.142:/var/backup/							mysql1-tc/

# fo-tc-redmine
backup			root@10.100.110.30:/etc/									redmine-tc/
backup_script	/usr/bin/ssh root@10.100.110.30 "/root/backup-mysql.sh"		redmine-tc/.dummy/snapshot
backup			root@10.100.110.30:/var/backup/								redmine-tc/
backup			root@10.100.110.30:/var/www/redmine							redmine-tc/

#
# backupTP environment (the fox server at tp)
#

# LOCALHOST
backup			/home/								localhost/

# install-tp
backup			root@10.100.130.2:/etc/				install-tp/

# ntp-tp
backup			root@10.100.130.3:/etc/				ntp-tp/

# mailrelay-tp
backup			root@10.100.130.4:/etc/				mailrelay-tp/

# rfweb-int-tp
backup			root@10.100.130.110:/etc/			rfweb-int-tp/

# rfweb-stable-tp
backup			root@10.100.130.111:/etc/			rfweb-stable-tp/

# rfweb-uat-tp
backup			root@10.100.130.112:/etc/			rfweb-uat-tp/

# fpweb-int-tp
backup			root@10.100.130.120:/etc/			fpweb-int-tp/

# fpweb-stable-tp
backup			root@10.100.130.121:/etc/			fpweb-stable-tp/

# fpweb-uat-tp
backup			root@10.100.130.122:/etc/			fpweb-uat-tp/

# vh01-tp
backup			root@10.100.130.201:/etc/			vh01-tp/

# vh02-tp
backup			root@10.100.130.202:/etc/			vh02-tp/

# vh03-tp
backup			root@10.100.130.203:/etc/			vh03-tp/

# bounce-tp
backup			root@10.100.130.10:/etc/			bounce-tp/
backup			root@10.100.130.10:/home/			bounce-tp/

# mysql1-tp
backup			root@10.100.130.100:/etc/			mysql1-tp/

# mysql2-tp
backup			root@10.100.130.101:/etc/																mysql2-tp/
backup_script	/usr/bin/ssh root@10.100.130.101 "/opt/syco/var/mysql/mysql-lvm-backup.py snapshot"		mysql2-tp/.dummy/snapshot
backup			root@10.100.130.101:/mnt/mysqlbackup/lib/mysql/											mysql2-tp/
backup_script	/usr/bin/ssh root@10.100.130.101 "/opt/syco/var/mysql/mysql-lvm-backup.py clean"		mysql2-tp/.dummy/clean

# vcs-tp
backup			root@10.100.130.22:/etc/																							vcs-tp/
backup_script	/usr/bin/ssh root@10.100.130.22 'rm -rf /var/backup-dump/;mkdir /var/backup-dump/;'									vcs-tp/.dummy/create_folder
backup_script	/usr/bin/ssh root@10.100.130.22 'cd /var/backup-dump/;for f in /git/*; do git clone $f; done;'						vcs-tp/.dummy/git_clone
backup_script	/usr/bin/ssh root@10.100.130.22 'for f in /svn/*; do svnadmin dump $f > "/var/backup-dump/${f##*/}.dump"; done;'	vcs-tp/.dummy/svn_dump
backup			root@10.100.130.22:/var/backup-dump																					vcs-tp/
backup_script	/usr/bin/ssh root@10.100.130.22 'rm -rf /var/backup-dump/'															vcs-tp/.dummy/delete_folder

# ldap-tp
backup			root@10.100.130.5:/etc/													ldap-tp/
backup_script	/usr/bin/ssh root@10.100.130.5 'source /etc/profile;syco ldap-dump'		ldap-tp/dummy/ldap_dump
backup			root@10.100.130.5:/root/dump.ldif										ldap-tp/

# file-tp
backup		root@10.100.130.20:/etc/						file-tp/
backup		root@10.100.130.20:/var/file-store/				file-tp/

# mail-tp
backup		root@10.100.130.21:/etc/						mail-tp/
# TODO: Extract info from mail

# fo-tp-php
backup		root@10.100.0.100:/etc/							fo-tp-php/
backup		root@10.100.0.100:/opt/RootLive/				fo-tp-php/

# End backup
backup_script	/bin/date "+ backupended at %c" > ended	01ended

#
# Not yet active servers.
#

#backup		root@10.100.130.23:/etc						build-tp/
#backup		root@10.100.130.12:/etc						monitor-tp/
#backup		root@10.100.130.13:/etc						scan-tp/
#backup		root@10.100.130.6:/etc						dns-tp/
#backup		root@10.100.130.7:/etc						log-tp/
#backup		root@10.100.130.130:/etc					foweb-int-tp/
#backup		root@10.100.130.132:/etc					foweb-uat-tp/

# # dalitst-tp
# backup		root@10.100.130.230:/etc/					dalitst-tp/
# backup		root@10.100.130.230:/opt/syco/				dalitst-tp/

# # mahetst-tp
# backup		root@10.100.130.240:/etc/					mahetst-tp/
# backup		root@10.100.130.240:/opt/syco/				mahetst-tp/

# # vh04-tp
# backup		root@10.100.130.204:/etc/					vh04-tp/
